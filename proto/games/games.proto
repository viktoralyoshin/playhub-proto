syntax = "proto3";

package games;

import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";


option go_package = "github.com/viktoralyoshin/playhub-proto/gen/go/games";

service GameService {
    
    rpc SearchGames (SearchGamesRequest) returns (GamesListResponse);

    rpc GetGame (GetGameRequest) returns (GetGameResponse);

    rpc GetGamesByGenre (GetGamesByGenreRequest) returns (GamesListResponse);

    rpc GetTopRatedGames (GetDiscoveryRequest) returns (GamesListResponse);

    rpc GetUpcomingGames (GetDiscoveryRequest) returns (GamesListResponse);

    rpc ListGames (ListGamesRequest) returns (GamesListResponse);

    rpc SetRating (RatingRequest) returns (google.protobuf.Empty);
}


message RatingRequest {
    string game_id = 1;
    uint32 rating = 2;
}

message SearchGamesRequest {
    string query = 1;
    uint32 limit = 2;
}

message GetGameRequest {
    oneof id_type {
        string game_id = 1; 
        string slug = 2;    
    }
}

message GetGameResponse {
    Game game = 1;
}

message GetGamesByGenreRequest {
    string genre_name = 1;
    uint32 limit = 2;
}

message GetDiscoveryRequest {
    uint32 limit = 1;
}

message GamesListResponse {
    repeated Game games = 1;
}

message ListGamesRequest {
    uint32 limit = 1;  
    uint32 offset = 2; 
    FilterType filter = 3;
}

enum FilterType {
    FIRST_RELEASE_DATE = 0;
    PLAYHUB_RATING = 1;
}

message Game {
    string id = 1;
    string igdb_id = 2;

    string name = 3;
    string slug = 4;
    string summary = 5;

    double igdb_rating = 6;
    double playhub_rating = 7;
    uint32 hypes = 8;

    string first_release_date = 9;
    repeated string release_dates = 10;

    string cover_url = 11;
    repeated string artwork_urls = 12;
    repeated string screenshots = 13;

    repeated string genres = 14;
    repeated string themes = 15;
    repeated string platforms = 16;

    google.protobuf.Timestamp created_at = 17;
    google.protobuf.Timestamp updated_at = 18;
}